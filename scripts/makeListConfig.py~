#!/usr/bin/env python
import os, sys
import re

outFolder = '/afs/cern.ch/user/s/spalluot/MTD/TB_FNAL_Mar23/Lab5015Analysis/scripts/'

cfgFolder = '/afs/cern.ch/user/s/spalluot/MTD/TB_FNAL_Mar23/Lab5015Analysis/cfg/'
path = cfgFolder

txtName = 'list_cfg_moduleCharacterization_LYSO'
txtPSName = 'list_cfg_drawPulseShapeTB_LYSO'

outFiles = {}
outFilesPS = {}


if outFolder[-1] != "/": outFolder += '/'

for path_, subdirs, files in os.walk(path):
    for name in files:
        if not name.startswith("moduleCharacterization"): continue
        if not name.endswith('.cfg'): continue        
        if 'LYSO' not in name:
            print 'cannot find LYSO ID for ', name
            continue

        print '\n\nname: ', name
        moduleNum = re.search("LYSO(\d\d\d)_", name).group(1)  # look for the three numbers after "LYSO"

        if moduleNum not in outFiles:
            print 'module ID: ', moduleNum
            outFiles[moduleNum] = open('%s/%s%s.txt'%(outFolder,txtName,str(moduleNum)),'w')        
    
        # write in the txt file
        outFiles[moduleNum].writelines('%s\n'%os.path.join(path_, name))

for outFile in outFiles:
    outFiles[outFile].close()

    with open('%s/%s%s.txt'%(outFolder,txtName,outFile),'r') as fp:
        for count, line in enumerate(fp):
            pass
    print '\n\tmodule:  ', outFile, '\tn n cfg files: ', count+1



